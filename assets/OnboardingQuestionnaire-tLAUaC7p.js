import{j as e,c as o,s as c,t as h}from"./index-DUOUId27.js";import{r as p}from"./vendor-state-CIiacWcF.js";import{B as M,i as d,L as y,A as L,ab as F}from"./vendor-ui-tYsHGQF9.js";import"./vendor-react-qkC6yhPU.js";import"./vendor-pdf-BScUNyKw.js";import"./vendor-supabase-CywEAasM.js";function A({userId:m,userEmail:w,onComplete:N}){const[s,i]=p.useState("restaurant"),[u,x]=p.useState(!1),[t,b]=p.useState({restaurantName:"",restaurantType:"restaurant",address:"",city:"",country:"Ireland",seatingCapacity:"",avgDailyCovers:"",openingDate:"",hasMultipleLocations:!1,numberOfLocations:"1",numberOfStaff:"",hasKitchenManager:!0,currentComplianceMethod:"paper",challenges:[]}),C=[{id:"temp_checks",label:"Forgetting temperature checks",icon:"ðŸŒ¡ï¸"},{id:"lost_paperwork",label:"Lost or incomplete paperwork",icon:"ðŸ“‹"},{id:"time_consuming",label:"Time-consuming manual logs",icon:"â±ï¸"},{id:"inspection_ready",label:"Missing records during inspections",icon:"ðŸ”"},{id:"staff_training",label:"Staff training gaps",icon:"ðŸ‘¥"},{id:"food_waste",label:"Food waste tracking",icon:"ðŸ—‘ï¸"},{id:"supplier_management",label:"Supplier compliance tracking",icon:"ðŸšš"},{id:"cleaning_schedules",label:"Cleaning schedule management",icon:"ðŸ§¹"}],k=a=>{b(l=>({...l,challenges:l.challenges.includes(a)?l.challenges.filter(n=>n!==a):[...l.challenges,a]}))},r=(a,l)=>{b(n=>({...n,[a]:l}))},g=()=>{switch(s){case"restaurant":return t.restaurantName.trim()&&t.address.trim()&&t.city.trim();case"details":return t.seatingCapacity&&t.avgDailyCovers;case"team":return t.numberOfStaff&&t.challenges.length>0;default:return!1}},S=async()=>{x(!0);try{const a={name:t.restaurantName,address:t.address,city:t.city,country:t.country,venue_type:t.restaurantType,seating_capacity:parseInt(t.seatingCapacity)||null,avg_daily_covers:parseInt(t.avgDailyCovers)||null,number_of_staff:parseInt(t.numberOfStaff)||null,has_kitchen_manager:t.hasKitchenManager,compliance_method:t.currentComplianceMethod,main_pain_point:t.challenges.join(", "),opening_date:t.openingDate||null,created_by:m};console.log("Creating venue with data:",a);const{data:l,error:n}=await c.from("venues").insert(a).select().single();if(n){console.error("Restaurant creation error:",n),console.error("Error details:",JSON.stringify(n,null,2)),h.error(`Failed to create restaurant: ${n.message||"Unknown error"}`),x(!1);return}console.log("Restaurant created successfully:",l);const O={id:l.id,name:t.restaurantName,address:`${t.address}, ${t.city}, ${t.country}`,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{error:f}=await c.from("sites").upsert(O,{onConflict:"id"});f?console.warn("Site creation warning (may already exist):",f):console.log("Site created/updated successfully with ID:",l.id);const{error:j}=await c.from("profiles").upsert({id:m,email:w,role:"owner",current_venue_id:l?.id,onboarding_completed:!0,updated_at:new Date().toISOString()});j&&console.warn("Profile update warning:",j);const{error:v}=await c.from("venue_members").insert({venue_id:l?.id,user_id:m,role:"owner",created_at:new Date().toISOString()});v&&console.warn("Venue member link warning:",v),i("complete"),h.success("Restaurant setup complete!"),setTimeout(()=>{N()},2e3)}catch(a){console.error("Onboarding error:",a),h.error("Something went wrong. Please try again.")}finally{x(!1)}},_=()=>{s==="restaurant"?i("details"):s==="details"?i("team"):s==="team"&&S()},D=()=>{s==="details"?i("restaurant"):s==="team"&&i("details")};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4 bg-gradient-to-br from-slate-950 via-slate-900 to-emerald-950 overflow-y-auto",children:e.jsxs("div",{className:"relative w-full max-w-2xl my-auto bg-gradient-to-br from-slate-900 to-slate-950 rounded-2xl sm:rounded-3xl border border-slate-700 shadow-2xl flex flex-col max-h-[95vh] sm:max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 pb-4 border-b border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-emerald-500 to-cyan-500 flex items-center justify-center",children:e.jsx(M,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Welcome! Let's Set Up Your Restaurant"}),e.jsx("p",{className:"text-sm text-slate-400",children:"This will only take 2 minutes"})]})]}),e.jsx("div",{className:"flex items-center gap-2 mt-6",children:["restaurant","details","team","complete"].map((a,l)=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("div",{className:o("w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold transition-all",s===a?"bg-emerald-500 text-white":["restaurant","details","team"].indexOf(s)>l||s==="complete"?"bg-emerald-500/20 text-emerald-400":"bg-slate-800 text-slate-500"),children:["restaurant","details","team"].indexOf(s)>l||s==="complete"?e.jsx(d,{className:"w-5 h-5"}):l+1}),l<3&&e.jsx("div",{className:o("flex-1 h-1 mx-2 rounded-full transition-all",["restaurant","details","team"].indexOf(s)>l||s==="complete"?"bg-emerald-500":"bg-slate-800")})]},a))})]}),e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 overflow-y-auto flex-1 min-h-0",children:[s==="restaurant"&&e.jsxs("div",{className:"space-y-5 animate-fade-in",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Tell us about your restaurant"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"Restaurant Name *"}),e.jsx("input",{type:"text",value:t.restaurantName,onChange:a=>r("restaurantName",a.target.value),placeholder:"The Golden Fork",className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"Business Type"}),e.jsxs("select",{value:t.restaurantType,onChange:a=>r("restaurantType",a.target.value),className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white focus:outline-none focus:border-emerald-500 transition-colors",children:[e.jsx("option",{value:"restaurant",children:"Restaurant"}),e.jsx("option",{value:"cafe",children:"CafÃ©"}),e.jsx("option",{value:"hotel",children:"Hotel Kitchen"}),e.jsx("option",{value:"catering",children:"Catering Company"}),e.jsx("option",{value:"food_truck",children:"Food Truck"}),e.jsx("option",{value:"bakery",children:"Bakery"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"Address *"}),e.jsx("input",{type:"text",value:t.address,onChange:a=>r("address",a.target.value),placeholder:"123 Main Street",className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500 transition-colors"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"City *"}),e.jsx("input",{type:"text",value:t.city,onChange:a=>r("city",a.target.value),placeholder:"Dublin",className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"Country"}),e.jsxs("select",{value:t.country,onChange:a=>r("country",a.target.value),className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white focus:outline-none focus:border-emerald-500 transition-colors",children:[e.jsx("option",{value:"Ireland",children:"Ireland"}),e.jsx("option",{value:"UK",children:"United Kingdom"}),e.jsx("option",{value:"Germany",children:"Germany"}),e.jsx("option",{value:"France",children:"France"}),e.jsx("option",{value:"Spain",children:"Spain"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),s==="details"&&e.jsxs("div",{className:"space-y-5 animate-fade-in",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Business Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"Seating Capacity *"}),e.jsx("input",{type:"number",value:t.seatingCapacity,onChange:a=>r("seatingCapacity",a.target.value),placeholder:"50",className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"Avg. Daily Covers *"}),e.jsx("input",{type:"number",value:t.avgDailyCovers,onChange:a=>r("avgDailyCovers",a.target.value),placeholder:"80",className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500 transition-colors"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"Opening Date (optional)"}),e.jsx("input",{type:"date",value:t.openingDate,onChange:a=>r("openingDate",a.target.value),className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white focus:outline-none focus:border-emerald-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-3",children:"Do you have multiple locations?"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>r("hasMultipleLocations",!1),className:o("flex-1 px-4 py-3 rounded-xl border-2 transition-all",t.hasMultipleLocations?"bg-slate-800/50 border-slate-700 text-slate-400 hover:border-slate-600":"bg-emerald-500/20 border-emerald-500 text-white"),children:"No, single location"}),e.jsx("button",{type:"button",onClick:()=>r("hasMultipleLocations",!0),className:o("flex-1 px-4 py-3 rounded-xl border-2 transition-all",t.hasMultipleLocations?"bg-emerald-500/20 border-emerald-500 text-white":"bg-slate-800/50 border-slate-700 text-slate-400 hover:border-slate-600"),children:"Yes, multiple"})]})]}),t.hasMultipleLocations&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"Number of Locations"}),e.jsx("input",{type:"number",value:t.numberOfLocations,onChange:a=>r("numberOfLocations",a.target.value),placeholder:"3",min:"2",className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500 transition-colors"})]})]}),s==="team"&&e.jsxs("div",{className:"space-y-5 animate-fade-in",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Team & Compliance"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"Number of Kitchen Staff *"}),e.jsx("input",{type:"number",value:t.numberOfStaff,onChange:a=>r("numberOfStaff",a.target.value),placeholder:"8",className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-emerald-500 transition-colors"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-3",children:"Do you have a dedicated kitchen manager?"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>r("hasKitchenManager",!0),className:o("flex-1 px-4 py-3 rounded-xl border-2 transition-all",t.hasKitchenManager?"bg-emerald-500/20 border-emerald-500 text-white":"bg-slate-800/50 border-slate-700 text-slate-400 hover:border-slate-600"),children:"Yes"}),e.jsx("button",{type:"button",onClick:()=>r("hasKitchenManager",!1),className:o("flex-1 px-4 py-3 rounded-xl border-2 transition-all",t.hasKitchenManager?"bg-slate-800/50 border-slate-700 text-slate-400 hover:border-slate-600":"bg-emerald-500/20 border-emerald-500 text-white"),children:"No"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-2",children:"Current Compliance Method"}),e.jsxs("select",{value:t.currentComplianceMethod,onChange:a=>r("currentComplianceMethod",a.target.value),className:"w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-xl text-white focus:outline-none focus:border-emerald-500 transition-colors",children:[e.jsx("option",{value:"paper",children:"Paper logs"}),e.jsx("option",{value:"excel",children:"Excel spreadsheets"}),e.jsx("option",{value:"other_software",children:"Other software"}),e.jsx("option",{value:"none",children:"No formal system"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-400 block mb-3",children:"What are your main compliance challenges? * (Select all that apply)"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:C.map(a=>e.jsxs("button",{type:"button",onClick:()=>k(a.id),className:o("flex items-center gap-3 px-4 py-3 rounded-xl border-2 transition-all text-left",t.challenges.includes(a.id)?"bg-emerald-500/20 border-emerald-500 text-white":"bg-slate-800/50 border-slate-700 text-slate-400 hover:border-slate-600"),children:[e.jsx("span",{className:"text-2xl",children:a.icon}),e.jsx("span",{className:"text-sm flex-1",children:a.label}),t.challenges.includes(a.id)&&e.jsx(d,{className:"w-5 h-5 text-emerald-400"})]},a.id))}),e.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:[t.challenges.length," challenge",t.challenges.length!==1?"s":""," selected"]})]})]}),s==="complete"&&e.jsxs("div",{className:"text-center py-12 animate-fade-in",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-6 rounded-full bg-emerald-500/20 flex items-center justify-center",children:e.jsx(d,{className:"w-12 h-12 text-emerald-400"})}),e.jsx("h3",{className:"text-3xl font-bold text-white mb-3",children:"All Set! ðŸŽ‰"}),e.jsxs("p",{className:"text-slate-400 mb-6 text-lg",children:[t.restaurantName," is ready to go.",e.jsx("br",{}),"Let's get you compliant!"]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-emerald-400",children:[e.jsx(y,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Loading your dashboard..."})]})]})]}),s!=="complete"&&e.jsxs("div",{className:"p-4 sm:p-6 flex items-center justify-between border-t border-slate-800 bg-slate-900/80 backdrop-blur-sm flex-shrink-0",children:[s!=="restaurant"?e.jsxs("button",{onClick:D,className:"flex items-center gap-2 px-5 py-3 text-slate-400 hover:text-white transition-colors",children:[e.jsx(L,{className:"w-4 h-4"}),"Back"]}):e.jsx("div",{}),e.jsx("button",{onClick:_,disabled:!g()||u,className:o("flex items-center gap-2 px-5 sm:px-8 py-3 rounded-xl font-semibold transition-all text-sm sm:text-base",g()&&!u?"bg-gradient-to-r from-emerald-500 to-cyan-500 text-white hover:shadow-lg hover:shadow-emerald-500/30":"bg-slate-700 text-slate-400 cursor-not-allowed"),children:u?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-5 h-5 animate-spin"}),"Setting up..."]}):s==="team"?e.jsxs(e.Fragment,{children:["Complete Setup",e.jsx(d,{className:"w-5 h-5"})]}):e.jsxs(e.Fragment,{children:["Continue",e.jsx(F,{className:"w-5 h-5"})]})})]})]})})}export{A as OnboardingQuestionnaire};
