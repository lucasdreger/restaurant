import{j as l,s as ve,u as xe,t as F}from"./index-264b_u-F.js";import{R as ye,r as N}from"./vendor-state-CIiacWcF.js";import{c as C}from"./utils-CBmmx2BN.js";import{a as be}from"./useVoiceRecognition-JRWpHVwB.js";import{T as I,p as we,W as Se,g as je,m as Z,h as ee,A as q,u as Ce,t as Ne,S as ke,y as Pe,Y as De,j as Fe,v as He,d as We,_ as Te,$ as Re}from"./vendor-ui-tYsHGQF9.js";import{E as Ae}from"./vendor-pdf-BScUNyKw.js";import"./vendor-react-qkC6yhPU.js";import"./vendor-supabase-CywEAasM.js";const te=ye.forwardRef(({className:t,variant:e="default",glow:i=!1,children:r,...n},a)=>l.jsxs("div",{ref:a,className:C("relative overflow-hidden rounded-[var(--radius)] transition-all duration-300","border",e==="default"&&["bg-[var(--bg-glass)] backdrop-blur-[var(--blur-md)]","border-[var(--border-glass)]","shadow-[var(--shadow-lg)]"],e==="heavy"&&["bg-[var(--bg-glass-heavy)] backdrop-blur-[var(--blur-lg)]","border-[var(--border-secondary)]","shadow-[var(--shadow-xl)]"],e==="interactive"&&["bg-[var(--bg-glass)] backdrop-blur-[var(--blur-sm)]","border-[var(--border-glass)]","hover:bg-[var(--bg-elevated)] hover:border-[var(--accent-primary)]/30","hover:shadow-[var(--shadow-glow)] hover:-translate-y-1","cursor-pointer"],e==="alert"&&["bg-red-500/10 backdrop-blur-[var(--blur-md)]","border-red-500/20","shadow-[var(--shadow-md)]"],i&&"after:absolute after:inset-0 after:rounded-[var(--radius)] after:shadow-[inset_0_0_20px_rgba(255,255,255,0.2)] after:pointer-events-none",t),...n,children:[e==="interactive"&&l.jsx("div",{className:"absolute inset-0 opacity-0 hover:opacity-100 transition-opacity duration-500 pointer-events-none bg-gradient-to-tr from-white/0 via-white/5 to-white/0"}),r]}));te.displayName="GlassCard";const ze=({field:t,value:e,onChange:i})=>t.type==="select"?l.jsxs("div",{className:"space-y-2",children:[l.jsxs("label",{className:"text-sm font-medium text-[var(--text-secondary)] flex items-center gap-2",children:[t.label,t.validation.required&&l.jsx("span",{className:"text-red-400",children:"*"})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:e||"",onChange:r=>i(r.target.value),className:C("w-full px-4 py-3 bg-[var(--bg-input)]/50 border border-[var(--border-primary)] rounded-lg appearance-none","focus:outline-none focus:ring-2 focus:ring-[var(--accent-primary)] focus:bg-white transition-all","text-[var(--text-primary)]"),children:[l.jsx("option",{value:"",disabled:!0,children:"Select an option..."}),t.validation.options?.map(r=>l.jsx("option",{value:r,children:r},r))]}),l.jsx(je,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"})]})]}):t.type==="boolean"?l.jsxs("div",{className:"flex items-center justify-between p-4 border border-[var(--border-primary)] rounded-lg hover:bg-[var(--bg-secondary)] transition-colors cursor-pointer",onClick:()=>i(!e),children:[l.jsxs("label",{className:"text-sm font-medium text-[var(--text-secondary)] cursor-pointer select-none",children:[t.label,t.validation.required&&l.jsx("span",{className:"text-red-400",children:"*"})]}),l.jsx("div",{className:C("w-6 h-6 rounded border flex items-center justify-center transition-colors",e?"bg-emerald-500 border-emerald-500 text-white":"border-gray-300 bg-white"),children:e&&l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}):l.jsxs("div",{className:"space-y-2",children:[l.jsxs("label",{className:"text-sm font-medium text-[var(--text-secondary)] flex items-center gap-2",children:[t.label,t.validation.required&&l.jsx("span",{className:"text-red-400",children:"*"})]}),l.jsxs("div",{className:"relative group",children:[l.jsx("input",{type:t.type==="number"||t.type==="temperature"?"number":t.type==="time"?"time":"text",value:e||"",onChange:r=>i(r.target.value),placeholder:t.placeholder,className:C("w-full px-4 py-3 bg-[var(--bg-input)]/50 border border-[var(--border-primary)] rounded-lg","focus:outline-none focus:ring-2 focus:ring-[var(--accent-primary)] focus:bg-white/80 transition-all","placeholder:text-gray-400")}),l.jsxs("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:[t.type==="temperature"&&l.jsx(Z,{size:18}),t.type==="time"&&l.jsx(ee,{size:18})]})]}),t.helpText&&l.jsx("p",{className:"text-xs text-[var(--text-muted)] pl-1",children:t.helpText})]});function Le({schema:t,onSave:e,initialData:i={}}){const[r,n]=N.useState(i),[a,o]=N.useState({}),[d,h]=N.useState([]),{startListening:s,stopListening:f,isListening:c}=be({onTranscript:p=>u(p)}),u=p=>{const m=p.toLowerCase(),x=m.match(/(?:temperature|degrees|temp)\s*(\d+(?:\.\d+)?)/);x&&g("temperature",parseFloat(x[1])),(m.includes("clean yes")||m.includes("is clean"))&&g("is_clean",!0)};N.useEffect(()=>{const p=[];t.correctiveActions.forEach(m=>{const[x,b,y]=m.trigger.split(" "),w=parseFloat(r[x]),D=parseFloat(y);!isNaN(w)&&!isNaN(D)&&b===">"&&w>D&&p.push(...m.actions)}),h(p)},[r,t]);const g=(p,m)=>{n(x=>({...x,[p]:m}))},v=()=>{const p={};if(t.fields.forEach(m=>{m.validation.required&&!r[m.id]&&(p[m.id]="This field is required")}),Object.keys(p).length>0){o(p);return}e(r)};return l.jsxs(te,{className:"max-w-2xl mx-auto p-6 md:p-8 space-y-8",glow:!0,children:[l.jsxs("div",{className:"flex items-start justify-between border-b border-[var(--border-secondary)] pb-6",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsxs("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 border border-blue-200 uppercase tracking-wide",children:[t.region," Standard"]}),l.jsxs("span",{className:"text-xs text-gray-500",children:["v",t.version]})]}),l.jsx("h2",{className:"text-2xl font-bold bg-clip-text text-transparent bg-[var(--gradient-primary)]",children:t.title}),l.jsx("p",{className:"text-[var(--text-secondary)] mt-1",children:"Complete all fields accurately. Records are immutable."})]}),l.jsx("div",{className:"bg-blue-50 p-3 rounded-full text-blue-600",children:l.jsx(Ee,{size:24})})]}),l.jsx("div",{className:"space-y-6",children:t.fields.map(p=>l.jsxs("div",{className:"animate-slide-in",children:[l.jsx(ze,{field:p,value:r[p.id],onChange:m=>g(p.id,m)}),a[p.id]&&l.jsxs("p",{className:"text-red-500 text-sm mt-1 flex items-center gap-1",children:[l.jsx(I,{size:12})," ",a[p.id]]})]},p.id))}),d.length>0&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 animate-pulse",children:[l.jsxs("div",{className:"flex items-center gap-2 text-red-700 font-bold mb-2",children:[l.jsx(I,{size:20}),l.jsx("span",{children:"Corrective Action Required"})]}),l.jsx("ul",{className:"list-disc list-inside text-red-600 text-sm space-y-1",children:d.map((p,m)=>l.jsx("li",{children:p},m))})]}),l.jsxs("div",{className:"pt-6 border-t border-[var(--border-secondary)] flex items-center justify-between",children:[l.jsxs("button",{className:C("flex items-center gap-2 transition-colors px-4 py-2 rounded-lg",c?"bg-red-100 text-red-600 animate-pulse":"text-[var(--text-muted)] hover:text-[var(--accent-primary)] hover:bg-[var(--bg-secondary)]"),onMouseDown:s,onMouseUp:f,onTouchStart:s,onTouchEnd:f,children:[l.jsx(we,{size:20}),l.jsx("span",{className:"text-sm font-medium",children:c?"Listening...":"Hold for Voice Input"})]}),l.jsxs("button",{onClick:v,className:"px-8 py-3 bg-[var(--accent-primary)] text-white rounded-xl font-bold shadow-lg shadow-blue-500/30 hover:shadow-blue-500/50 hover:-translate-y-0.5 transition-all flex items-center gap-2",children:[l.jsx(Se,{size:18}),"Sign & Save Record"]})]})]})}function Ee({size:t}){return l.jsxs("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),l.jsx("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})}const R={id:"fsai_fridge_temp_v1",title:"Cold Storage Temperature Log (FSAI)",region:"IE",type:"temp_log",version:"1.0.0",fields:[{id:"unit_name",label:"Unit Name / ID",type:"text",validation:{required:!0},placeholder:"e.g., Walk-in Fridge 1"},{id:"temperature",label:"Current Temperature",type:"temperature",validation:{required:!0,min:-5,max:8,unit:"°C"},helpText:"Ensure probe is stabilized before recording."},{id:"time_check",label:"Time of Check",type:"time",validation:{required:!0}},{id:"checked_by",label:"Checked By",type:"text",validation:{required:!0},defaultValue:"Current User"},{id:"is_clean",label:"Unit Clean & Organize?",type:"boolean",validation:{required:!0}}],correctiveActions:[{trigger:"temperature > 5",actions:["Check door seal","Move food to backup unit","Call maintenance if persists > 2h"]},{trigger:"temperature > 8",actions:["CRITICAL: Discard high-risk food","Quarantine unit immediately"]}]},Be={id:"fsai_daily_cleaning_v1",title:"Daily Cleaning Schedule (FSAI)",region:"IE",type:"cleaning",version:"1.0.0",fields:[{id:"area",label:"Area / Equipment",type:"select",validation:{required:!0,options:["Prep Surfaces","Sinks & Taps","Floors","Walk-in Fridge","Line Fridge","Cookline (Hob/Grill)","Dishwasher Area"]}},{id:"chemicals_used",label:"Chemicals Used",type:"select",validation:{required:!0,options:["Sanitizer D10","Degreaser","Floor Cleaner","Hot Soapy Water"]}},{id:"method",label:"Cleaning Method",type:"text",validation:{required:!0},defaultValue:"Clean, Rinse, Sanitize, Air Dry"},{id:"time_completed",label:"Time Completed",type:"time",validation:{required:!0}},{id:"cleaned_by",label:"Cleaned By",type:"text",validation:{required:!0}},{id:"verified_by_manager",label:"Manager Verification",type:"boolean",validation:{required:!0},helpText:"I verify this area meets hygiene standards."}],correctiveActions:[{trigger:"verified_by_manager == false",actions:["Reclean area immediately","Retrain staff on cleaning procedure"]}]},Me={id:"fsai_staff_training_v1",title:"Staff Training Record (FSAI)",region:"IE",type:"temp_log",version:"1.0.0",fields:[{id:"employee_name",label:"Employee Name",type:"text",validation:{required:!0}},{id:"training_module",label:"Training Module",type:"select",validation:{required:!0,options:["Level 1 Food Safety (Induction)","Level 2 Food Safety","Allergen Management Awareness","HACCP Principles","Personal Hygiene","Cross Contamination Prevention"]}},{id:"trainer_name",label:"Trainer / Supervisor",type:"text",validation:{required:!0}},{id:"date_completed",label:"Date Completed",type:"text",validation:{required:!0},placeholder:"YYYY-MM-DD"},{id:"assessment_pass",label:"Assessment Passed?",type:"boolean",validation:{required:!0}}],correctiveActions:[{trigger:"assessment_pass == false",actions:["Schedule re-training","Limit duties until passed"]}]};async function _e(t,e,i,r="app"){let n="pass";i.temperature&&Number(i.temperature)>8&&(n="fail"),i.assessment_pass===!1&&(n="fail"),i.verified_by_manager===!1&&(n="fail");const{data:a,error:o}=await ve.from("compliance_logs").insert({site_id:t,schema_id:e,data:i,status:n,source:r}).select();if(o)throw new Error(o.message);return a}function re(t,e,i,r,n){r=r||{};var a=1.15,o=n.internal.scaleFactor,d=n.internal.getFontSize()/o,h=n.getLineHeightFactor?n.getLineHeightFactor():a,s=d*h,f=/\r\n|\r|\n/g,c="",u=1;if((r.valign==="middle"||r.valign==="bottom"||r.halign==="center"||r.halign==="right")&&(c=typeof t=="string"?t.split(f):t,u=c.length||1),i+=d*(2-a),r.valign==="middle"?i-=u/2*s:r.valign==="bottom"&&(i-=u*s),r.halign==="center"||r.halign==="right"){var g=d;if(r.halign==="center"&&(g*=.5),c&&u>=1){for(var v=0;v<c.length;v++)n.text(c[v],e-n.getStringUnitWidth(c[v])*g,i),i+=s;return n}e-=n.getStringUnitWidth(t)*g}return r.halign==="justify"?n.text(t,e,i,{maxWidth:r.maxWidth||100,align:"justify"}):n.text(t,e,i),n}var O={},k=(function(){function t(e){this.jsPDFDocument=e,this.userStyles={textColor:e.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:e.internal.getFontSize(),fontStyle:e.internal.getFont().fontStyle,font:e.internal.getFont().fontName,lineWidth:e.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:e.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return t.setDefaults=function(e,i){i===void 0&&(i=null),i?i.__autoTableDocumentDefaults=e:O=e},t.unifyColor=function(e){return Array.isArray(e)?e:typeof e=="number"?[e,e,e]:typeof e=="string"?[e]:null},t.prototype.applyStyles=function(e,i){var r,n,a;i===void 0&&(i=!1),e.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(e.fontStyle);var o=this.jsPDFDocument.internal.getFont(),d=o.fontStyle,h=o.fontName;if(e.font&&(h=e.font),e.fontStyle){d=e.fontStyle;var s=this.getFontList()[h];s&&s.indexOf(d)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(s[0]),d=s[0])}if(this.jsPDFDocument.setFont(h,d),e.fontSize&&this.jsPDFDocument.setFontSize(e.fontSize),!i){var f=t.unifyColor(e.fillColor);f&&(r=this.jsPDFDocument).setFillColor.apply(r,f),f=t.unifyColor(e.textColor),f&&(n=this.jsPDFDocument).setTextColor.apply(n,f),f=t.unifyColor(e.lineColor),f&&(a=this.jsPDFDocument).setDrawColor.apply(a,f),typeof e.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(e.lineWidth)}},t.prototype.splitTextToSize=function(e,i,r){return this.jsPDFDocument.splitTextToSize(e,i,r)},t.prototype.rect=function(e,i,r,n,a){return this.jsPDFDocument.rect(e,i,r,n,a)},t.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},t.prototype.getTextWidth=function(e){return this.jsPDFDocument.getTextWidth(e)},t.prototype.getDocument=function(){return this.jsPDFDocument},t.prototype.setPage=function(e){this.jsPDFDocument.setPage(e)},t.prototype.addPage=function(){return this.jsPDFDocument.addPage()},t.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},t.prototype.getGlobalOptions=function(){return O||{}},t.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},t.prototype.pageSize=function(){var e=this.jsPDFDocument.internal.pageSize;return e.width==null&&(e={width:e.getWidth(),height:e.getHeight()}),e},t.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},t.prototype.getLineHeightFactor=function(){var e=this.jsPDFDocument;return e.getLineHeightFactor?e.getLineHeightFactor():1.15},t.prototype.getLineHeight=function(e){return e/this.scaleFactor()*this.getLineHeightFactor()},t.prototype.pageNumber=function(){var e=this.jsPDFDocument.internal.getCurrentPageInfo();return e?e.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},t})(),B=function(t,e){return B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i[n]=r[n])},B(t,e)};function ie(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");B(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}var ne=(function(t){ie(e,t);function e(i){var r=t.call(this)||this;return r._element=i,r}return e})(Array);function Ie(t){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/t,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function qe(t){var e={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return e[t]}function H(t,e,i){i.applyStyles(e,!0);var r=Array.isArray(t)?t:[t],n=r.map(function(a){return i.getTextWidth(a)}).reduce(function(a,o){return Math.max(a,o)},0);return n}function ae(t,e,i,r){var n=e.settings.tableLineWidth,a=e.settings.tableLineColor;t.applyStyles({lineWidth:n,lineColor:a});var o=se(n,!1);o&&t.rect(i.x,i.y,e.getWidth(t.pageSize().width),r.y-i.y,o)}function se(t,e){var i=t>0,r=e||e===0;return i&&r?"DF":i?"S":r?"F":null}function T(t,e){var i,r,n,a;if(t=t||e,Array.isArray(t)){if(t.length>=4)return{top:t[0],right:t[1],bottom:t[2],left:t[3]};if(t.length===3)return{top:t[0],right:t[1],bottom:t[2],left:t[1]};if(t.length===2)return{top:t[0],right:t[1],bottom:t[0],left:t[1]};t.length===1?t=t[0]:t=e}return typeof t=="object"?(typeof t.vertical=="number"&&(t.top=t.vertical,t.bottom=t.vertical),typeof t.horizontal=="number"&&(t.right=t.horizontal,t.left=t.horizontal),{left:(i=t.left)!==null&&i!==void 0?i:e,top:(r=t.top)!==null&&r!==void 0?r:e,right:(n=t.right)!==null&&n!==void 0?n:e,bottom:(a=t.bottom)!==null&&a!==void 0?a:e}):(typeof t!="number"&&(t=e),{top:t,right:t,bottom:t,left:t})}function oe(t,e){var i=T(e.settings.margin,0);return t.pageSize().width-(i.left+i.right)}function Oe(t,e,i,r,n){var a={},o=1.3333333333333333,d=A(e,function(y){return n.getComputedStyle(y).backgroundColor});d!=null&&(a.fillColor=d);var h=A(e,function(y){return n.getComputedStyle(y).color});h!=null&&(a.textColor=h);var s=Ue(r,i);s&&(a.cellPadding=s);var f="borderTopColor",c=o*i,u=r.borderTopWidth;if(r.borderBottomWidth===u&&r.borderRightWidth===u&&r.borderLeftWidth===u){var g=(parseFloat(u)||0)/c;g&&(a.lineWidth=g)}else a.lineWidth={top:(parseFloat(r.borderTopWidth)||0)/c,right:(parseFloat(r.borderRightWidth)||0)/c,bottom:(parseFloat(r.borderBottomWidth)||0)/c,left:(parseFloat(r.borderLeftWidth)||0)/c},a.lineWidth.top||(a.lineWidth.right?f="borderRightColor":a.lineWidth.bottom?f="borderBottomColor":a.lineWidth.left&&(f="borderLeftColor"));var v=A(e,function(y){return n.getComputedStyle(y)[f]});v!=null&&(a.lineColor=v);var p=["left","right","center","justify"];p.indexOf(r.textAlign)!==-1&&(a.halign=r.textAlign),p=["middle","bottom","top"],p.indexOf(r.verticalAlign)!==-1&&(a.valign=r.verticalAlign);var m=parseInt(r.fontSize||"");isNaN(m)||(a.fontSize=m/o);var x=Ye(r);x&&(a.fontStyle=x);var b=(r.fontFamily||"").toLowerCase();return t.indexOf(b)!==-1&&(a.font=b),a}function Ye(t){var e="";return(t.fontWeight==="bold"||t.fontWeight==="bolder"||parseInt(t.fontWeight)>=700)&&(e="bold"),(t.fontStyle==="italic"||t.fontStyle==="oblique")&&(e+="italic"),e}function A(t,e){var i=le(t,e);if(!i)return null;var r=i.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var n=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],a=parseInt(r[4]);return a===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function le(t,e){var i=e(t);return i==="rgba(0, 0, 0, 0)"||i==="transparent"||i==="initial"||i==="inherit"?t.parentElement==null?null:le(t.parentElement,e):i}function Ue(t,e){var i=[t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft],r=96/(72/e),n=(parseInt(t.lineHeight)-parseInt(t.fontSize))/e/2,a=i.map(function(d){return parseInt(d||"0")/r}),o=T(a,0);return n>o.top&&(o.top=n),n>o.bottom&&(o.bottom=n),o}function de(t,e,i,r,n){var a,o;r===void 0&&(r=!1),n===void 0&&(n=!1);var d;typeof e=="string"?d=i.document.querySelector(e):d=e;var h=Object.keys(t.getFontList()),s=t.scaleFactor(),f=[],c=[],u=[];if(!d)return console.error("Html table could not be found with input: ",e),{head:f,body:c,foot:u};for(var g=0;g<d.rows.length;g++){var v=d.rows[g],p=(o=(a=v?.parentElement)===null||a===void 0?void 0:a.tagName)===null||o===void 0?void 0:o.toLowerCase(),m=Ke(h,s,i,v,r,n);m&&(p==="thead"?f.push(m):p==="tfoot"?u.push(m):c.push(m))}return{head:f,body:c,foot:u}}function Ke(t,e,i,r,n,a){for(var o=new ne(r),d=0;d<r.cells.length;d++){var h=r.cells[d],s=i.getComputedStyle(h);if(n||s.display!=="none"){var f=void 0;a&&(f=Oe(t,h,e,s,i)),o.push({rowSpan:h.rowSpan,colSpan:h.colSpan,styles:f,_element:h,content:$e(h)})}}var c=i.getComputedStyle(r);if(o.length>0&&(n||c.display!=="none"))return o}function $e(t){var e=t.cloneNode(!0);return e.innerHTML=e.innerHTML.replace(/\n/g,"").replace(/ +/g," "),e.innerHTML=e.innerHTML.split(/<br.*?>/).map(function(i){return i.trim()}).join(`
`),e.innerText||e.textContent||""}function Ge(t,e,i){for(var r=0,n=[t,e,i];r<n.length;r++){var a=n[r];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function S(t,e,i,r,n){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(t),o=1;o<arguments.length;o++){var d=arguments[o];if(d!=null)for(var h in d)Object.prototype.hasOwnProperty.call(d,h)&&(a[h]=d[h])}return a}function he(t,e){var i=new k(t),r=i.getDocumentOptions(),n=i.getGlobalOptions();Ge(n,r,e);var a=S({},n,r,e),o;typeof window<"u"&&(o=window);var d=Ve(n,r,e),h=Je(n,r,e),s=Qe(i,a),f=Ze(i,a,o);return{id:e.tableId,content:f,hooks:h,styles:d,settings:s}}function Ve(t,e,i){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(h){if(h==="columnStyles"){var s=t[h],f=e[h],c=i[h];r.columnStyles=S({},s,f,c)}else{var u=[t,e,i],g=u.map(function(v){return v[h]||{}});r[h]=S({},g[0],g[1],g[2])}},a=0,o=Object.keys(r);a<o.length;a++){var d=o[a];n(d)}return r}function Je(t,e,i){for(var r=[t,e,i],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,o=r;a<o.length;a++){var d=o[a];d.didParseCell&&n.didParseCell.push(d.didParseCell),d.willDrawCell&&n.willDrawCell.push(d.willDrawCell),d.didDrawCell&&n.didDrawCell.push(d.didDrawCell),d.willDrawPage&&n.willDrawPage.push(d.willDrawPage),d.didDrawPage&&n.didDrawPage.push(d.didDrawPage)}return n}function Qe(t,e){var i,r,n,a,o,d,h,s,f,c,u,g,v=T(e.margin,40/t.scaleFactor()),p=(i=Xe(t,e.startY))!==null&&i!==void 0?i:v.top,m;e.showFoot===!0?m="everyPage":e.showFoot===!1?m="never":m=(r=e.showFoot)!==null&&r!==void 0?r:"everyPage";var x;e.showHead===!0?x="everyPage":e.showHead===!1?x="never":x=(n=e.showHead)!==null&&n!==void 0?n:"everyPage";var b=(a=e.useCss)!==null&&a!==void 0?a:!1,y=e.theme||(b?"plain":"striped"),w=!!e.horizontalPageBreak,D=(o=e.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(d=e.includeHiddenHtml)!==null&&d!==void 0?d:!1,useCss:b,theme:y,startY:p,margin:v,pageBreak:(h=e.pageBreak)!==null&&h!==void 0?h:"auto",rowPageBreak:(s=e.rowPageBreak)!==null&&s!==void 0?s:"auto",tableWidth:(f=e.tableWidth)!==null&&f!==void 0?f:"auto",showHead:x,showFoot:m,tableLineWidth:(c=e.tableLineWidth)!==null&&c!==void 0?c:0,tableLineColor:(u=e.tableLineColor)!==null&&u!==void 0?u:200,horizontalPageBreak:w,horizontalPageBreakRepeat:D,horizontalPageBreakBehaviour:(g=e.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function Xe(t,e){var i=t.getLastAutoTable(),r=t.scaleFactor(),n=t.pageNumber(),a=!1;if(i&&i.startPageNumber){var o=i.startPageNumber+i.pageNumber-1;a=o===n}return typeof e=="number"?e:(e==null||e===!1)&&a&&i?.finalY!=null?i.finalY+20/r:null}function Ze(t,e,i){var r=e.head||[],n=e.body||[],a=e.foot||[];if(e.html){var o=e.includeHiddenHtml;if(i){var d=de(t,e.html,i,o,e.useCss)||{};r=d.head||r,n=d.body||r,a=d.foot||r}else console.error("Cannot parse html in non browser environment")}var h=e.columns||et(r,n,a);return{columns:h,head:r,body:n,foot:a}}function et(t,e,i){var r=t[0]||e[0]||i[0]||[],n=[];return Object.keys(r).filter(function(a){return a!=="_element"}).forEach(function(a){var o=1,d;Array.isArray(r)?d=r[parseInt(a)]:d=r[a],typeof d=="object"&&!Array.isArray(d)&&(o=d?.colSpan||1);for(var h=0;h<o;h++){var s=void 0;Array.isArray(r)?s=n.length:s=a+(h>0?"_".concat(h):"");var f={dataKey:s};n.push(f)}}),n}var M=(function(){function t(e,i,r){this.table=i,this.pageNumber=i.pageNumber,this.settings=i.settings,this.cursor=r,this.doc=e.getDocument()}return t})(),tt=(function(t){ie(e,t);function e(i,r,n,a,o,d){var h=t.call(this,i,r,d)||this;return h.cell=n,h.row=a,h.column=o,h.section=a.section,h}return e})(M),rt=(function(){function t(e,i){this.pageNumber=1,this.id=e.id,this.settings=e.settings,this.styles=e.styles,this.hooks=e.hooks,this.columns=i.columns,this.head=i.head,this.body=i.body,this.foot=i.foot}return t.prototype.getHeadHeight=function(e){return this.head.reduce(function(i,r){return i+r.getMaxCellHeight(e)},0)},t.prototype.getFootHeight=function(e){return this.foot.reduce(function(i,r){return i+r.getMaxCellHeight(e)},0)},t.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},t.prototype.callCellHooks=function(e,i,r,n,a,o){for(var d=0,h=i;d<h.length;d++){var s=h[d],f=new tt(e,this,r,n,a,o),c=s(f)===!1;if(r.text=Array.isArray(r.text)?r.text:[r.text],c)return!1}return!0},t.prototype.callEndPageHooks=function(e,i){e.applyStyles(e.userStyles);for(var r=0,n=this.hooks.didDrawPage;r<n.length;r++){var a=n[r];a(new M(e,this,i))}},t.prototype.callWillDrawPageHooks=function(e,i){for(var r=0,n=this.hooks.willDrawPage;r<n.length;r++){var a=n[r];a(new M(e,this,i))}},t.prototype.getWidth=function(e){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var i=this.columns.reduce(function(n,a){return n+a.wrappedWidth},0);return i}else{var r=this.settings.margin;return e-r.left-r.right}},t})(),fe=(function(){function t(e,i,r,n,a){a===void 0&&(a=!1),this.height=0,this.raw=e,e instanceof ne&&(this.raw=e._element,this.element=e._element),this.index=i,this.section=r,this.cells=n,this.spansMultiplePages=a}return t.prototype.getMaxCellHeight=function(e){var i=this;return e.reduce(function(r,n){var a;return Math.max(r,((a=i.cells[n.index])===null||a===void 0?void 0:a.height)||0)},0)},t.prototype.hasRowSpan=function(e){var i=this;return e.filter(function(r){var n=i.cells[r.index];return n?n.rowSpan>1:!1}).length>0},t.prototype.canEntireRowFit=function(e,i){return this.getMaxCellHeight(i)<=e},t.prototype.getMinimumRowHeight=function(e,i){var r=this;return e.reduce(function(n,a){var o=r.cells[a.index];if(!o)return 0;var d=i.getLineHeight(o.styles.fontSize),h=o.padding("vertical"),s=h+d;return s>n?s:n},0)},t})(),ue=(function(){function t(e,i,r){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=i,this.section=r,this.raw=e;var a=e;e!=null&&typeof e=="object"&&!Array.isArray(e)?(this.rowSpan=e.rowSpan||1,this.colSpan=e.colSpan||1,a=(n=e.content)!==null&&n!==void 0?n:e,e._element&&(this.raw=e._element)):(this.rowSpan=1,this.colSpan=1);var o=a!=null?""+a:"",d=/\r\n|\r|\n/g;this.text=o.split(d)}return t.prototype.getTextPos=function(){var e;if(this.styles.valign==="top")e=this.y+this.padding("top");else if(this.styles.valign==="bottom")e=this.y+this.height-this.padding("bottom");else{var i=this.height-this.padding("vertical");e=this.y+i/2+this.padding("top")}var r;if(this.styles.halign==="right")r=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");r=this.x+n/2+this.padding("left")}else r=this.x+this.padding("left");return{x:r,y:e}},t.prototype.getContentHeight=function(e,i){i===void 0&&(i=1.15);var r=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/e*i,a=r*n+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},t.prototype.padding=function(e){var i=T(this.styles.cellPadding,0);return e==="vertical"?i.top+i.bottom:e==="horizontal"?i.left+i.right:i[e]},t})(),it=(function(){function t(e,i,r){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=e,this.raw=i,this.index=r}return t.prototype.getMaxCustomCellWidth=function(e){for(var i=0,r=0,n=e.allRows();r<n.length;r++){var a=n[r],o=a.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(i=Math.max(i,o.styles.cellWidth))}return i},t})();function nt(t,e){at(t,e);var i=[],r=0;e.columns.forEach(function(a){var o=a.getMaxCustomCellWidth(e);o?a.width=o:(a.width=a.wrappedWidth,i.push(a)),r+=a.width});var n=e.getWidth(t.pageSize().width)-r;n&&(n=_(i,n,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),n&&(n=_(i,n,function(a){return a.minWidth})),n=Math.abs(n),!e.settings.horizontalPageBreak&&n>.1/t.scaleFactor()&&(n=n<1?n:Math.round(n),console.log("Of the table content, ".concat(n," units width could not fit page"))),ot(e),lt(e,t),st(e)}function at(t,e){var i=t.scaleFactor(),r=e.settings.horizontalPageBreak,n=oe(t,e);e.allRows().forEach(function(a){for(var o=0,d=e.columns;o<d.length;o++){var h=d[o],s=a.cells[h.index];if(s){var f=e.hooks.didParseCell;e.callCellHooks(t,f,s,a,h,null);var c=s.padding("horizontal");s.contentWidth=H(s.text,s.styles,t)+c;var u=H(s.text.join(" ").split(/[^\S\u00A0]+/),s.styles,t);if(s.minReadableWidth=u+s.padding("horizontal"),typeof s.styles.cellWidth=="number")s.minWidth=s.styles.cellWidth,s.wrappedWidth=s.styles.cellWidth;else if(s.styles.cellWidth==="wrap"||r===!0)s.contentWidth>n?(s.minWidth=n,s.wrappedWidth=n):(s.minWidth=s.contentWidth,s.wrappedWidth=s.contentWidth);else{var g=10/i;s.minWidth=s.styles.minCellWidth||g,s.wrappedWidth=s.contentWidth,s.minWidth>s.wrappedWidth&&(s.wrappedWidth=s.minWidth)}}}}),e.allRows().forEach(function(a){for(var o=0,d=e.columns;o<d.length;o++){var h=d[o],s=a.cells[h.index];if(s&&s.colSpan===1)h.wrappedWidth=Math.max(h.wrappedWidth,s.wrappedWidth),h.minWidth=Math.max(h.minWidth,s.minWidth),h.minReadableWidth=Math.max(h.minReadableWidth,s.minReadableWidth);else{var f=e.styles.columnStyles[h.dataKey]||e.styles.columnStyles[h.index]||{},c=f.cellWidth||f.minCellWidth;c&&typeof c=="number"&&(h.minWidth=c,h.wrappedWidth=c)}s&&(s.colSpan>1&&!h.minWidth&&(h.minWidth=s.minWidth),s.colSpan>1&&!h.wrappedWidth&&(h.wrappedWidth=s.minWidth))}})}function _(t,e,i){for(var r=e,n=t.reduce(function(g,v){return g+v.wrappedWidth},0),a=0;a<t.length;a++){var o=t[a],d=o.wrappedWidth/n,h=r*d,s=o.width+h,f=i(o),c=s<f?f:s;e-=c-o.width,o.width=c}if(e=Math.round(e*1e10)/1e10,e){var u=t.filter(function(g){return e<0?g.width>i(g):!0});u.length&&(e=_(u,e,i))}return e}function st(t){for(var e={},i=1,r=t.allRows(),n=0;n<r.length;n++)for(var a=r[n],o=0,d=t.columns;o<d.length;o++){var h=d[o],s=e[h.index];if(i>1)i--,delete a.cells[h.index];else if(s)s.cell.height+=a.height,i=s.cell.colSpan,delete a.cells[h.index],s.left--,s.left<=1&&delete e[h.index];else{var f=a.cells[h.index];if(!f)continue;if(f.height=a.height,f.rowSpan>1){var c=r.length-n,u=f.rowSpan>c?c:f.rowSpan;e[h.index]={cell:f,left:u,row:a}}}}}function ot(t){for(var e=t.allRows(),i=0;i<e.length;i++)for(var r=e[i],n=null,a=0,o=0,d=0;d<t.columns.length;d++){var h=t.columns[d];if(o-=1,o>1&&t.columns[d+1])a+=h.width,delete r.cells[h.index];else if(n){var s=n;delete r.cells[h.index],n=null,s.width=h.width+a}else{var s=r.cells[h.index];if(!s)continue;if(o=s.colSpan,a=0,s.colSpan>1){n=s,a+=h.width;continue}s.width=h.width+a}}}function lt(t,e){for(var i={count:0,height:0},r=0,n=t.allRows();r<n.length;r++){for(var a=n[r],o=0,d=t.columns;o<d.length;o++){var h=d[o],s=a.cells[h.index];if(s){e.applyStyles(s.styles,!0);var f=s.width-s.padding("horizontal");if(s.styles.overflow==="linebreak")s.text=e.splitTextToSize(s.text,f+1/e.scaleFactor(),{fontSize:s.styles.fontSize});else if(s.styles.overflow==="ellipsize")s.text=Y(s.text,f,s.styles,e,"...");else if(s.styles.overflow==="hidden")s.text=Y(s.text,f,s.styles,e,"");else if(typeof s.styles.overflow=="function"){var c=s.styles.overflow(s.text,f);typeof c=="string"?s.text=[c]:s.text=c}s.contentHeight=s.getContentHeight(e.scaleFactor(),e.getLineHeightFactor());var u=s.contentHeight/s.rowSpan;s.rowSpan>1&&i.count*i.height<u*s.rowSpan?i={height:u,count:s.rowSpan}:i&&i.count>0&&i.height>u&&(u=i.height),u>a.height&&(a.height=u)}}i.count--}}function Y(t,e,i,r,n){return t.map(function(a){return dt(a,e,i,r,n)})}function dt(t,e,i,r,n){var a=1e4*r.scaleFactor();if(e=Math.ceil(e*a)/a,e>=H(t,i,r))return t;for(;e<H(t+n,i,r)&&!(t.length<=1);)t=t.substring(0,t.length-1);return t.trim()+n}function ce(t,e){var i=new k(t),r=ht(e,i.scaleFactor()),n=new rt(e,r);return nt(i,n),i.applyStyles(i.userStyles),n}function ht(t,e){var i=t.content,r=ut(i.columns);if(i.head.length===0){var n=U(r,"head");n&&i.head.push(n)}if(i.foot.length===0){var n=U(r,"foot");n&&i.foot.push(n)}var a=t.settings.theme,o=t.styles;return{columns:r,head:z("head",i.head,r,o,a,e),body:z("body",i.body,r,o,a,e),foot:z("foot",i.foot,r,o,a,e)}}function z(t,e,i,r,n,a){var o={},d=e.map(function(h,s){for(var f=0,c={},u=0,g=0,v=0,p=i;v<p.length;v++){var m=p[v];if(o[m.index]==null||o[m.index].left===0)if(g===0){var x=void 0;Array.isArray(h)?x=h[m.index-u-f]:x=h[m.dataKey];var b={};typeof x=="object"&&!Array.isArray(x)&&(b=x?.styles||{});var y=ct(t,m,s,n,r,a,b),w=new ue(x,y,t);c[m.dataKey]=w,c[m.index]=w,g=w.colSpan-1,o[m.index]={left:w.rowSpan-1,times:g}}else g--,u++;else o[m.index].left--,g=o[m.index].times,f++}return new fe(h,s,t,c)});return d}function U(t,e){var i={};return t.forEach(function(r){if(r.raw!=null){var n=ft(e,r.raw);n!=null&&(i[r.dataKey]=n)}}),Object.keys(i).length>0?i:null}function ft(t,e){if(t==="head"){if(typeof e=="object")return e.header||null;if(typeof e=="string"||typeof e=="number")return e}else if(t==="foot"&&typeof e=="object")return e.footer;return null}function ut(t){return t.map(function(e,i){var r,n;return typeof e=="object"?n=(r=e.dataKey)!==null&&r!==void 0?r:i:n=i,new it(n,e,i)})}function ct(t,e,i,r,n,a,o){var d=qe(r),h;t==="head"?h=n.headStyles:t==="body"?h=n.bodyStyles:t==="foot"&&(h=n.footStyles);var s=S({},d.table,d[t],n.styles,h),f=n.columnStyles[e.dataKey]||n.columnStyles[e.index]||{},c=t==="body"?f:{},u=t==="body"&&i%2===0?S({},d.alternateRow,n.alternateRowStyles):{},g=Ie(a),v=S({},g,s,u,c);return S(v,o)}function gt(t,e,i){var r;i===void 0&&(i={});var n=oe(t,e),a=new Map,o=[],d=[],h=[];Array.isArray(e.settings.horizontalPageBreakRepeat)?h=e.settings.horizontalPageBreakRepeat:(typeof e.settings.horizontalPageBreakRepeat=="string"||typeof e.settings.horizontalPageBreakRepeat=="number")&&(h=[e.settings.horizontalPageBreakRepeat]),h.forEach(function(u){var g=e.columns.find(function(v){return v.dataKey===u||v.index===u});g&&!a.has(g.index)&&(a.set(g.index,!0),o.push(g.index),d.push(e.columns[g.index]),n-=g.wrappedWidth)});for(var s=!0,f=(r=i?.start)!==null&&r!==void 0?r:0;f<e.columns.length;){if(a.has(f)){f++;continue}var c=e.columns[f].wrappedWidth;if(s||n>=c)s=!1,o.push(f),d.push(e.columns[f]),n-=c;else break;f++}return{colIndexes:o,columns:d,lastIndex:f-1}}function pt(t,e){for(var i=[],r=0;r<e.columns.length;r++){var n=gt(t,e,{start:r});n.columns.length&&(i.push(n),r=n.lastIndex)}return i}function ge(t,e){var i=e.settings,r=i.startY,n=i.margin,a={x:n.left,y:r},o=e.getHeadHeight(e.columns)+e.getFootHeight(e.columns),d=r+n.bottom+o;if(i.pageBreak==="avoid"){var h=e.body,s=h.reduce(function(u,g){return u+g.height},0);d+=s}var f=new k(t);(i.pageBreak==="always"||i.startY!=null&&d>f.pageSize().height)&&(me(f),a.y=n.top),e.callWillDrawPageHooks(f,a);var c=S({},a);e.startPageNumber=f.pageNumber(),i.horizontalPageBreak?mt(f,e,c,a):(f.applyStyles(f.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&e.head.forEach(function(u){return j(f,e,u,a,e.columns)}),f.applyStyles(f.userStyles),e.body.forEach(function(u,g){var v=g===e.body.length-1;W(f,e,u,v,c,a,e.columns)}),f.applyStyles(f.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&e.foot.forEach(function(u){return j(f,e,u,a,e.columns)})),ae(f,e,c,a),e.callEndPageHooks(f,a),e.finalY=a.y,t.lastAutoTable=e,f.applyStyles(f.userStyles)}function mt(t,e,i,r){var n=pt(t,e),a=e.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(s,f){t.applyStyles(t.userStyles),f>0?P(t,e,i,r,s.columns,!0):K(t,e,r,s.columns),vt(t,e,i,r,s.columns),L(t,e,r,s.columns)});else for(var o=-1,d=n[0],h=function(){var s=o;if(d){t.applyStyles(t.userStyles);var f=d.columns;o>=0?P(t,e,i,r,f,!0):K(t,e,r,f),s=$(t,e,o+1,r,f),L(t,e,r,f)}var c=s-o;n.slice(1).forEach(function(u){t.applyStyles(t.userStyles),P(t,e,i,r,u.columns,!0),$(t,e,o+1,r,u.columns,c),L(t,e,r,u.columns)}),o=s};o<e.body.length-1;)h()}function K(t,e,i,r){var n=e.settings;t.applyStyles(t.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&e.head.forEach(function(a){return j(t,e,a,i,r)})}function vt(t,e,i,r,n){t.applyStyles(t.userStyles),e.body.forEach(function(a,o){var d=o===e.body.length-1;W(t,e,a,d,i,r,n)})}function $(t,e,i,r,n,a){t.applyStyles(t.userStyles),a=a??e.body.length;var o=Math.min(i+a,e.body.length),d=-1;return e.body.slice(i,o).forEach(function(h,s){var f=i+s===e.body.length-1,c=pe(t,e,f,r);h.canEntireRowFit(c,n)&&(j(t,e,h,r,n),d=i+s)}),d}function L(t,e,i,r){var n=e.settings;t.applyStyles(t.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&e.foot.forEach(function(a){return j(t,e,a,i,r)})}function xt(t,e,i){var r=i.getLineHeight(t.styles.fontSize),n=t.padding("vertical"),a=Math.floor((e-n)/r);return Math.max(0,a)}function yt(t,e,i,r){var n={};t.spansMultiplePages=!0,t.height=0;for(var a=0,o=0,d=i.columns;o<d.length;o++){var h=d[o],s=t.cells[h.index];if(s){Array.isArray(s.text)||(s.text=[s.text]);var f=new ue(s.raw,s.styles,s.section);f=S(f,s),f.text=[];var c=xt(s,e,r);s.text.length>c&&(f.text=s.text.splice(c,s.text.length));var u=r.scaleFactor(),g=r.getLineHeightFactor();s.contentHeight=s.getContentHeight(u,g),s.contentHeight>=e&&(s.contentHeight=e,f.styles.minCellHeight-=e),s.contentHeight>t.height&&(t.height=s.contentHeight),f.contentHeight=f.getContentHeight(u,g),f.contentHeight>a&&(a=f.contentHeight),n[h.index]=f}}var v=new fe(t.raw,-1,t.section,n,!0);v.height=a;for(var p=0,m=i.columns;p<m.length;p++){var h=m[p],f=v.cells[h.index];f&&(f.height=v.height);var s=t.cells[h.index];s&&(s.height=t.height)}return v}function bt(t,e,i,r){var n=t.pageSize().height,a=r.settings.margin,o=a.top+a.bottom,d=n-o;e.section==="body"&&(d-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var h=e.getMinimumRowHeight(r.columns,t),s=h<i;if(h>d)return console.log("Will not be able to print row ".concat(e.index," correctly since it's minimum height is larger than page height")),!0;if(!s)return!1;var f=e.hasRowSpan(r.columns),c=e.getMaxCellHeight(r.columns)>d;return c?(f&&console.log("The content of row ".concat(e.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||r.settings.rowPageBreak==="avoid")}function W(t,e,i,r,n,a,o){var d=pe(t,e,r,a);if(i.canEntireRowFit(d,o))j(t,e,i,a,o);else if(bt(t,i,d,e)){var h=yt(i,d,e,t);j(t,e,i,a,o),P(t,e,n,a,o),W(t,e,h,r,n,a,o)}else P(t,e,n,a,o),W(t,e,i,r,n,a,o)}function j(t,e,i,r,n){r.x=e.settings.margin.left;for(var a=0,o=n;a<o.length;a++){var d=o[a],h=i.cells[d.index];if(!h){r.x+=d.width;continue}t.applyStyles(h.styles),h.x=r.x,h.y=r.y;var s=e.callCellHooks(t,e.hooks.willDrawCell,h,i,d,r);if(s===!1){r.x+=d.width;continue}wt(t,h,r);var f=h.getTextPos();re(h.text,f.x,f.y,{halign:h.styles.halign,valign:h.styles.valign,maxWidth:Math.ceil(h.width-h.padding("left")-h.padding("right"))},t.getDocument()),e.callCellHooks(t,e.hooks.didDrawCell,h,i,d,r),r.x+=d.width}r.y+=i.height}function wt(t,e,i){var r=e.styles;if(t.getDocument().setFillColor(t.getDocument().getFillColor()),typeof r.lineWidth=="number"){var n=se(r.lineWidth,r.fillColor);n&&t.rect(e.x,i.y,e.width,e.height,n)}else typeof r.lineWidth=="object"&&(r.fillColor&&t.rect(e.x,i.y,e.width,e.height,"F"),St(t,e,i,r.lineWidth))}function St(t,e,i,r){var n,a,o,d;r.top&&(n=i.x,a=i.y,o=i.x+e.width,d=i.y,r.right&&(o+=.5*r.right),r.left&&(n-=.5*r.left),h(r.top,n,a,o,d)),r.bottom&&(n=i.x,a=i.y+e.height,o=i.x+e.width,d=i.y+e.height,r.right&&(o+=.5*r.right),r.left&&(n-=.5*r.left),h(r.bottom,n,a,o,d)),r.left&&(n=i.x,a=i.y,o=i.x,d=i.y+e.height,r.top&&(a-=.5*r.top),r.bottom&&(d+=.5*r.bottom),h(r.left,n,a,o,d)),r.right&&(n=i.x+e.width,a=i.y,o=i.x+e.width,d=i.y+e.height,r.top&&(a-=.5*r.top),r.bottom&&(d+=.5*r.bottom),h(r.right,n,a,o,d));function h(s,f,c,u,g){t.getDocument().setLineWidth(s),t.getDocument().line(f,c,u,g,"S")}}function pe(t,e,i,r){var n=e.settings.margin.bottom,a=e.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&i)&&(n+=e.getFootHeight(e.columns)),t.pageSize().height-r.y-n}function P(t,e,i,r,n,a){n===void 0&&(n=[]),a===void 0&&(a=!1),t.applyStyles(t.userStyles),e.settings.showFoot==="everyPage"&&!a&&e.foot.forEach(function(d){return j(t,e,d,r,n)}),e.callEndPageHooks(t,r);var o=e.settings.margin;ae(t,e,i,r),me(t),e.pageNumber++,r.x=o.left,r.y=o.top,i.y=o.top,e.callWillDrawPageHooks(t,r),e.settings.showHead==="everyPage"&&(e.head.forEach(function(d){return j(t,e,d,r,n)}),t.applyStyles(t.userStyles))}function me(t){var e=t.pageNumber();t.setPage(e+1);var i=t.pageNumber();return i===e?(t.addPage(),!0):!1}function jt(t){t.API.autoTable=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=e[0],n=he(this,r),a=ce(this,n);return ge(this,a),this},t.API.lastAutoTable=!1,t.API.autoTableText=function(e,i,r,n){re(e,i,r,n,this)},t.API.autoTableSetDefaults=function(e){return k.setDefaults(e,this),this},t.autoTableSetDefaults=function(e,i){k.setDefaults(e,i)},t.API.autoTableHtmlToJson=function(e,i){var r;if(i===void 0&&(i=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new k(this),a=de(n,e,window,i,!1),o=a.head,d=a.body,h=((r=o[0])===null||r===void 0?void 0:r.map(function(s){return s.content}))||[];return{columns:h,rows:d,data:d}}}var E;function G(t,e){var i=he(t,e),r=ce(t,i);ge(t,r)}try{if(typeof window<"u"&&window){var V=window,J=V.jsPDF||((E=V.jspdf)===null||E===void 0?void 0:E.jsPDF);J&&jt(J)}}catch(t){console.error("Could not apply autoTable plugin",t)}const Q={overallScore:96,coolingCompliance:98},X=[{id:"1",date:"2026-01-15",type:"Daily Self-Check",score:100,status:"passed",findings:0},{id:"2",date:"2026-01-14",type:"Daily Self-Check",score:95,status:"passed",findings:1},{id:"3",date:"2026-01-10",type:"FSAI Inspection",score:96,status:"passed",findings:2},{id:"4",date:"2026-01-07",type:"Internal Audit",score:92,status:"action-needed",findings:3}],Ct=[{id:"1",category:"Cooling Records",items:12,completed:12,status:"complete"},{id:"2",category:"Temperature Logs",items:24,completed:23,status:"in-progress"},{id:"3",category:"Staff Training",items:8,completed:8,status:"complete"},{id:"4",category:"Equipment Calibration",items:6,completed:5,status:"in-progress"},{id:"5",category:"Cleaning Records",items:15,completed:15,status:"complete"},{id:"6",category:"Supplier Documentation",items:10,completed:10,status:"complete"}];function At({onBack:t}){const[e,i]=N.useState(!1),[r,n]=N.useState(R),[a,o]=N.useState(!1),{currentSite:d}=xe(),h=u=>{n(u),i(!0)},s=()=>{o(!0);const u=new Ae;u.setFontSize(22),u.setTextColor(40,40,40),u.text("Kitchen Compliance Report",14,20),u.setFontSize(12),u.setTextColor(100,100,100),u.text(`Generated on: ${new Date().toLocaleDateString()}`,14,30),u.text("Location: Dublin City Centre Branch",14,36),u.setDrawColor(200,200,200),u.line(14,45,196,45),u.setFontSize(14),u.setTextColor(0,0,0),u.text("Compliance Summary",14,55),G(u,{startY:60,head:[["Metric","Score","Status"]],body:[["Overall Score","96%","Excellent"],["Cooling Compliance","98%","Passing"],["Temp. Checks","94%","Passing"],["Documentation","97%","Passing"]],theme:"grid",headStyles:{fillColor:[66,66,66]}});const g=u.lastAutoTable.finalY||60;u.text("Recent Audit Logs",14,g+15),G(u,{startY:g+20,head:[["Date","Type","Score","Status","Findings"]],body:X.map(p=>[p.date,p.type,`${p.score}%`,p.status.toUpperCase(),p.findings.toString()]),theme:"striped",headStyles:{fillColor:[41,128,185]}});const v=u.internal.getNumberOfPages();for(let p=1;p<=v;p++)u.setPage(p),u.setFontSize(10),u.setTextColor(150),u.text("Kitchen Ops - Official FSAI Compliance Record",14,285),u.text(`Page ${p} of ${v}`,190,285,{align:"right"});u.save(`compliance-report-${new Date().toISOString().split("T")[0]}.pdf`),o(!1),F.success("Report downloaded successfully")},f=async u=>{if(d?.id)try{await _e(d.id,r.id,u,"app"),F.success("Log saved to cloud successfully!")}catch(g){console.error("Save failed",g),F.error("Failed to save log to cloud.")}else F.info("No site selected, log saved locally (mock)");i(!1)};if(e)return l.jsxs("div",{className:"min-h-screen bg-theme-primary text-theme-primary p-6 md:p-12 animate-fade-in",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[l.jsx("button",{onClick:()=>i(!1),className:"p-3 rounded-full hover:bg-theme-ghost transition-colors",children:l.jsx(q,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-light tracking-tight",children:"New Entry"}),l.jsxs("p",{className:"text-theme-muted font-light",children:["Compliance Log • ",r.region]})]})]}),l.jsx("div",{className:"card-stunning p-6",children:l.jsx(Le,{schema:r,onSave:f})})]});const c=u=>u>=95?"text-green-500":u>=80?"text-amber-500":"text-red-500";return l.jsxs("div",{className:"min-h-screen bg-theme-primary text-theme-primary transition-colors duration-300",children:[l.jsx("div",{className:"sticky top-0 z-10 bg-glass-heavy border-b border-theme-primary p-4 md:p-6 backdrop-blur-md",children:l.jsxs("div",{className:"max-w-7xl mx-auto flex flex-col md:flex-row md:items-center justify-between gap-6",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:t,className:"p-3 rounded-xl hover:bg-theme-ghost text-theme-secondary hover:text-theme-primary transition-colors",children:l.jsx(q,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-theme-primary to-theme-secondary",children:"Compliance"}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),l.jsx("p",{className:"text-theme-muted font-medium text-xs uppercase tracking-wider",children:"Live Monitoring"})]})]})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("button",{onClick:s,disabled:a,className:"btn-stunning btn-ghost flex items-center gap-2",children:[l.jsx(Ce,{size:18}),a?"Generating...":"Export Report"]}),l.jsxs("button",{onClick:()=>h(R),className:"btn-stunning btn-primary flex items-center gap-2",children:[l.jsx(Ne,{size:18}),"New Log Entry"]})]})]})}),l.jsxs("div",{className:"p-6 md:p-10 max-w-7xl mx-auto space-y-10 pb-24",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[l.jsxs("button",{onClick:()=>h(R),className:"p-4 text-left card-stunning hover:border-theme-secondary transition-colors group",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx("div",{className:"p-2 bg-blue-500/10 text-blue-500 rounded-lg group-hover:bg-blue-500 group-hover:text-white transition-colors",children:l.jsx(Z,{size:20})}),l.jsx("span",{className:"font-semibold",children:"Temperature Log"})]}),l.jsx("p",{className:"text-sm text-theme-muted",children:"Fridges, Freezers & Blast Chillers"})]}),l.jsxs("button",{onClick:()=>h(Be),className:"p-4 text-left card-stunning hover:border-theme-secondary transition-colors group",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx("div",{className:"p-2 bg-emerald-500/10 text-emerald-500 rounded-lg group-hover:bg-emerald-500 group-hover:text-white transition-colors",children:l.jsx(ke,{size:20})}),l.jsx("span",{className:"font-semibold",children:"Cleaning Schedule"})]}),l.jsx("p",{className:"text-sm text-theme-muted",children:"Daily, Weekly & Deep Clean Tasks"})]}),l.jsxs("button",{onClick:()=>h(Me),className:"p-4 text-left card-stunning hover:border-theme-secondary transition-colors group",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx("div",{className:"p-2 bg-purple-500/10 text-purple-500 rounded-lg group-hover:bg-purple-500 group-hover:text-white transition-colors",children:l.jsx(Pe,{size:20})}),l.jsx("span",{className:"font-semibold",children:"Staff Training"})]}),l.jsx("p",{className:"text-sm text-theme-muted",children:"Induction & Allergen Certs"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"card-stunning p-6 flex flex-col justify-between h-40 group",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-xs font-bold text-theme-muted uppercase tracking-wider",children:"Overall Score"})}),l.jsxs("div",{className:"flex items-end justify-between",children:[l.jsxs("span",{className:"text-5xl font-light tracking-tighter text-theme-primary",children:[Q.overallScore,"%"]}),l.jsx(De,{className:"w-6 h-6 text-emerald-500 mb-2 group-hover:scale-110 transition-transform"})]})]}),l.jsxs("div",{className:"card-stunning p-6 flex flex-col justify-between h-40 group",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-xs font-bold text-theme-muted uppercase tracking-wider",children:"Cooling Safety"})}),l.jsxs("div",{className:"flex items-end justify-between",children:[l.jsxs("span",{className:"text-5xl font-light tracking-tighter text-theme-primary",children:[Q.coolingCompliance,"%"]}),l.jsx(Fe,{className:"w-6 h-6 text-blue-500 mb-2 group-hover:scale-110 transition-transform"})]})]}),l.jsxs("div",{className:"card-stunning p-6 flex flex-col justify-between h-40 group",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xs font-bold text-theme-muted uppercase tracking-wider",children:"Next Audit"}),l.jsx("p",{className:"text-xs text-theme-muted mt-1",children:"Scheduled Inspection"})]}),l.jsxs("div",{className:"flex items-end justify-between",children:[l.jsx("span",{className:"text-2xl font-light text-theme-primary",children:"Feb 15"}),l.jsx(He,{className:"w-6 h-6 text-theme-muted mb-2"})]})]}),l.jsxs("div",{className:"p-6 rounded-2xl border border-red-500/20 bg-red-500/5 shadow-sm flex flex-col justify-between h-40",children:[l.jsx("div",{children:l.jsx("h3",{className:"text-xs font-bold text-red-500 uppercase tracking-wider",children:"Action Needed"})}),l.jsxs("div",{className:"flex items-end justify-between",children:[l.jsx("span",{className:"text-4xl font-light tracking-tighter text-red-500",children:"3"}),l.jsx("div",{className:"px-3 py-1 bg-red-500 text-white rounded-full text-xs font-bold",children:"URGENT"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[l.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[l.jsxs("h2",{className:"text-xl font-light tracking-tight text-theme-primary flex items-center gap-2",children:[l.jsx(We,{className:"w-5 h-5 text-theme-muted"}),"Daily Tasks"]}),l.jsx("div",{className:"space-y-3",children:Ct.map(u=>l.jsxs("div",{className:"group card-stunning p-4 cursor-pointer flex items-center justify-between hover:scale-[1.01] transition-transform",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:C("w-10 h-10 rounded-full flex items-center justify-center transition-colors",u.status==="complete"?"bg-emerald-500/10 text-emerald-500":"bg-theme-ghost text-theme-muted"),children:u.status==="complete"?l.jsx(Te,{size:20}):l.jsx(ee,{size:20})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-theme-primary",children:u.category}),l.jsxs("p",{className:"text-sm text-theme-muted",children:[u.completed,"/",u.items," verified"]})]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-24 h-1.5 bg-theme-ghost rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-theme-primary rounded-full",style:{width:`${u.completed/u.items*100}%`}})}),l.jsx(Nt,{className:"w-4 h-4 text-theme-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})]},u.id))})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("h2",{className:"text-xl font-light tracking-tight text-theme-primary flex items-center gap-2",children:[l.jsx(Re,{className:"w-5 h-5 text-theme-muted"}),"Recent Logs"]}),l.jsx("div",{className:"bg-theme-ghost rounded-2xl p-1 border border-theme-primary",children:X.map(u=>l.jsxs("div",{className:"p-4 hover:bg-theme-card rounded-xl transition-colors border-b border-theme-ghost last:border-0",children:[l.jsxs("div",{className:"flex justify-between items-start mb-1",children:[l.jsx("span",{className:"font-medium text-theme-primary",children:u.type}),l.jsx("span",{className:C("text-xs font-bold px-2 py-0.5 rounded-full uppercase",u.status==="passed"?"bg-emerald-500/10 text-emerald-600":"bg-amber-500/10 text-amber-600"),children:u.status==="action-needed"?"Action":"Pass"})]}),l.jsxs("div",{className:"flex justify-between items-end",children:[l.jsx("span",{className:"text-xs text-theme-muted",children:u.date}),l.jsx("div",{className:"text-right",children:l.jsxs("span",{className:C("font-bold",c(u.score)),children:[u.score,"%"]})})]})]},u.id))})]})]})]})]})}function Nt({className:t}){return l.jsxs("svg",{className:t,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("rect",{width:"20",height:"5",x:"2",y:"3",rx:"1"}),l.jsx("path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 0 0 0 2-2V8"}),l.jsx("path",{d:"M10 12h4"})]})}export{At as ComplianceScreen};
